# Событийный цикл: микрозадачи и макрозадачи

## Событийный цикл

Идея событийного цикла такая, что есть бесконечный цикл, в котором JavaScript ожидает задачи, исполняет их и снова ожидает появление новых.

То есть пока есть задачи движок выполнит их, начиная с самой старой. Если задач нет, то бездействовать до появления новой задачи.

Если движок занят чем-то другим, то задача ставится в очередь.

Задачи из очеред выполняются по принципе "Первый пришел - первый ушел".

Рендеринг никогда не происходит по время выполнения задачи движком. Изменения в DOM отрисовываются только после того, как задача выполнена.

Если задача выполняется долго, то браузер не может выполнять другие задачи, поэтому спустя время бразуер предложит убить долговыполняющуюся задачу.

## Макрозадачи и Микрозадачи

Микрозадачи приходят только из кода. Обычно они создаются промисами с помощью выполнения обработчиков. Микрозадачи под капотом также используются и в `await`.

Также есть функция `queueMicrotask(func)`, которая помещает `func` в очередь микрозадач.

Сразу после каждой макрозадачи движок исполняет все задачи из очереди микрозадач перед тем, как выполнить следующую макрозадачу или отобразить изменения на странице, или сделать что-то ещё.

Все микрозадачи завершаются до обработки каких-либо событий или рендеринга, или перехода к другой макрозадаче.