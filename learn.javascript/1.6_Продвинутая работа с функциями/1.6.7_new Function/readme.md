# Синтаксис "new Function"

## Синтаксис

```
let func = new Function([arg1, arg2, ...argN], functionBody);
```

Функция задается с заданным число аргументов `arg1...argN` и телом `functionBody`

```
let sum = new Function('a', 'b', 'return a + b');

alert( sum(1, 2) ); // 3
```

Для функции без аргументов, достаточно просто передать `functionBody`

Главное отличие от других способов объявления функции заключается в том, что функция создается из строки, переданной во время выполнения

`new Function` позволяет превратить любую строку в функцию. Например, можно получить функцию с сервера и затем выполнить ее


```
let str = ... код, полученный с сервера динамически ...

let func = new Function(str);
func();
```

## Замыкание

Обычно функция запоминает, где родилась, в специальном свойстве `[[Environment]]`. Это ссылка лексическое окружение.

Но когда функция создается через `new Function`, в ее `[[Environment]]` записывается ссылка на глобальное лексическое окружение.

Такая функция имеет доступ только к глобальным переменным.

```
function getFunc() {
  let value = "test";

  let func = new Function('alert(value)');

  return func;
}

getFunc()(); // ошибка: value не определено
```

Это связано с тем, что перед отправкой JS-кода на проект код сжимается (оптимизируется) с помощью минификатора, удаляя лишние пробелы, комментарии, а так же локальным переменным дается более укореченные имена.

Если `new Function` имела бы доступ к внешним переменным, возникли бы проблемы с минификаторами.

