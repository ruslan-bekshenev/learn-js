# Методы объекта, "this"

Объектно-ориентированное программирование (ООП) - код и использование объектов для представления сущностей реального мира. 

## Ключевое слово «this» в методах

Для доступа к информации внутри объекта метод может использовать ключевое слово this, где this - текущий объект.

Значение this вычисляется во время выполнения кода и зависит от контекста.

## Вызов без объекта: this == undefined

```
  function sayHi() {
    alert(this);
  }

  sayHi(); // undefined
```

Из примера, в строгом режиме **this** будет считаться undefined, в нестрогом значением **this** будет глобальный объект

В JavaScript this является «свободным», его значение вычисляется в момент вызова метода и не зависит от того, где этот метод был объявлен, а зависит от того, какой объект вызывает метод (какой объект стоит «перед точкой»).

## Внутренняя реализация: Ссылочный тип

```
  let user = {
    name: "Джон",
    hi() { alert(this.name); },
    bye() { alert("Пока"); }
  };

  user.hi(); // Джон (простой вызов метода работает хорошо)

  // теперь давайте попробуем вызывать user.hi или user.bye
  // в зависимости от имени пользователя user.name
  (user.name == "Джон" ? user.hi : user.bye)(); // Ошибка!
```

При вызове функции в соседней строке будет ошибка, потому что this будет равно **undefined** - теряется контекст

При записи функции в другую переменную также теряется контекст, потому что записывается в переменную ссылка

```
  let user = {
    name: "Джон",
    hi() { alert(this.name); }
  };

  // разделим получение метода объекта и его вызов в разных строках
  let hi = user.hi;
  hi(); // Ошибка, потому что значением this является undefined
```

Для работы вызовов типа user.hi(), JavaScript использует трюк – точка '.' возвращает не саму функцию, а специальное значение «ссылочного типа», называемого Reference Type.

Reference Type - внутренний тип.

Значение ссылочного типа – это набор из из трёх значений (base, name, strict), где:

- base – это объект.
- name – это имя свойства объекта.
- strict – это режим исполнения. Является true, если действует строгий режим (use strict).

Результатом доступа к свойству user.hi является не функция, а значение ссылочного типа. Для user.hi в строгом режиме оно будет таким:

```
  // значение ссылочного типа (Reference Type)
  (user, "hi", true)
```

Ссылочный тип – исключительно внутренний, промежуточный, используемый, чтобы передать информацию от точки . до вызывающих скобок ().

## У стрелочных функций нет "this"

Если мы используем this внутри стрелочной функции, то его значение берётся из внешней «нормальной» функции.